<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEXC Trading Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> MEXC Trading Dashboard</h1>
            <p>Phân tích chi tiết hoạt động giao dịch</p>
        </div>

        <!-- Import Excel Section -->
        <div class="import-section" id="importSection">
            <div class="import-card">
                <div class="import-header">
                    <i class="fas fa-file-excel"></i>
                    <h2>Import File Excel</h2>
                    <p>Chọn file Excel để phân tích dữ liệu giao dịch</p>
                </div>
                
                <div class="file-upload-area" id="fileUploadArea">
                    <div class="upload-content">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Kéo thả file Excel vào đây</h3>
                        <p>hoặc</p>
                        <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-folder-open"></i> Chọn file
                        </button>
                        <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                        <div class="file-info">
                            <small>Hỗ trợ: .xlsx, .xls, .csv</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="loading" id="loading" style="display: none;">
            <i class="fas fa-spinner"></i>
            <p>Đang xử lý dữ liệu...</p>
        </div>

        <div id="dashboard" style="display: none;">
            <!-- Nút import mới -->
            <div class="dashboard-header">
                <button class="import-new-btn" id="importNewBtn">
                    <i class="fas fa-file-import"></i> Import file mới
                </button>
                <div class="file-info-display" id="fileInfoDisplay"></div>
            </div>

            <!-- Bộ lọc -->
            <div class="filters">
                <div class="filter-group">
                    <label>Loại giao dịch:</label>
                    <select id="transactionTypeFilter">
                        <option value="">Tất cả</option>
                    </select>
                    
                    <label>Cặp giao dịch:</label>
                    <select id="tradingPairFilter">
                        <option value="">Tất cả</option>
                    </select>
                    
                    <label>Từ ngày:</label>
                    <input type="date" id="dateFromFilter">
                    
                    <label>Đến ngày:</label>
                    <input type="date" id="dateToFilter">

                    <button class="reset-filter-btn" id="resetFilters">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>

            <!-- Thống kê tổng quan -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon profit"><i class="fas fa-coins"></i></div>
                    <div class="value" id="totalProfit">0</div>
                    <div class="label">Tổng Lãi/Lỗ (USDT)</div>
                </div>
                <div class="stat-card">
                    <div class="icon neutral"><i class="fas fa-exchange-alt"></i></div>
                    <div class="value" id="totalTransactions">0</div>
                    <div class="label">Tổng số giao dịch</div>
                </div>
                <div class="stat-card">
                    <div class="icon loss"><i class="fas fa-receipt"></i></div>
                    <div class="value" id="totalFees">0</div>
                    <div class="label">Tổng phí (USDT)</div>
                </div>
                <div class="stat-card">
                    <div class="icon neutral"><i class="fas fa-calendar-alt"></i></div>
                    <div class="value" id="tradingDays">0</div>
                    <div class="label">Số ngày giao dịch</div>
                </div>
                <div class="stat-card">
                    <div class="icon neutral"><i class="fas fa-percentage"></i></div>
                    <div class="value" id="winRate">0%</div>
                    <div class="label">Tỷ lệ thắng</div>
                </div>
                <div class="stat-card">
                    <div class="icon neutral"><i class="fas fa-chart-line"></i></div>
                    <div class="value" id="avgProfit">0</div>
                    <div class="label">Lãi TB/giao dịch</div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="charts-grid">
                <div class="chart-container">
                    <h3><i class="fas fa-chart-line"></i> Lãi/Lỗ hàng ngày</h3>
                    <canvas id="profitChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-chart-pie"></i> Phân loại giao dịch</h3>
                    <canvas id="transactionTypeChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-chart-bar"></i> Top cặp giao dịch</h3>
                    <canvas id="topPairsChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-chart-area"></i> Lãi/Lỗ tích lũy</h3>
                    <canvas id="cumulativeProfitChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-calendar-day"></i> Lợi nhuận theo ngày</h3>
                    <canvas id="dailyProfitChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-clock"></i> Hoạt động theo giờ</h3>
                    <canvas id="hourlyActivityChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-coins"></i> Phí giao dịch</h3>
                    <canvas id="feeChart"></canvas>
                </div>
            </div>

            <!-- Bảng giao dịch chi tiết -->
            <div class="table-container">
                <div class="table-header">
                    <h3><i class="fas fa-table"></i> Chi tiết giao dịch</h3>
                    <div class="table-controls">
                        <input type="text" id="searchInput" placeholder="Tìm kiếm...">
                        <select id="pageSize">
                            <option value="50">50 dòng</option>
                            <option value="100" selected>100 dòng</option>
                            <option value="200">200 dòng</option>
                        </select>
                        <button id="exportBtn" class="export-btn">
                            <i class="fas fa-download"></i> Xuất Excel
                        </button>
                    </div>
                </div>
                <div class="table-content">
                    <table id="transactionsTable">
                        <thead>
                            <tr>
                                <th onclick="sortTable(0)">Thời gian <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(1)">Cặp giao dịch <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(2)">Loại <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(3)">Số tiền <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(4)">Lãi/Lỗ <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(5)">Phí <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(6)">Tổng <i class="fas fa-sort"></i></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="pagination" id="pagination"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
