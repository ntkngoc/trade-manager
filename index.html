<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEXC Trading Dashboard Pro</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .stat-number {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 0.8em;
            padding: 5px 10px;
            border-radius: 15px;
            margin-top: 10px;
            display: inline-block;
        }

        .profit {
            color: #27ae60;
        }

        .loss {
            color: #e74c3c;
        }

        .neutral {
            color: #3498db;
        }

        .profit-bg {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .loss-bg {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #764ba2;
        }

        .upload-area.dragover {
            background: rgba(102, 126, 234, 0.2);
            border-color: #764ba2;
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        .btn-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .data-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: none;
        }

        .alert-success {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid #27ae60;
            color: #27ae60;
        }

        .alert-error {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid #e74c3c;
            color: #e74c3c;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìä MEXC Trading Dashboard Pro</h1>
            <p>Ph√¢n t√≠ch chuy√™n s√¢u ‚Ä¢ Qu·∫£n l√Ω r·ªßi ro ‚Ä¢ T·ªëi ∆∞u hi·ªáu su·∫•t</p>
        </div>

        <!-- Stats Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">T·ªïng V·ªën Hi·ªán T·∫°i</div>
                <div class="stat-number profit" id="currentCapital">$1,587.58</div>
                <div class="stat-change profit-bg" id="capitalChange">+41.7% t·ª´ v·ªën ban ƒë·∫ßu</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">T·ªïng L√£i/L·ªó R√≤ng</div>
                <div class="stat-number profit" id="totalPnL">$166.87</div>
                <div class="stat-change profit-bg" id="pnlChange">ROC: 9.24%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">T·ª∑ L·ªá Th·∫Øng</div>
                <div class="stat-number profit" id="winRate">81.82%</div>
                <div class="stat-change profit-bg">9/11 ng√†y c√≥ l√£i</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">T·ªïng L·ªánh Th·ª±c Hi·ªán</div>
                <div class="stat-number neutral" id="totalTrades">120</div>
                <div class="stat-change profit-bg">Avg: 10.9 l·ªánh/ng√†y</div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="dashboard-grid">
            <!-- Import Excel Section -->
            <div class="card">
                <h3>üìÅ Import D·ªØ Li·ªáu Trading</h3>
                
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div style="font-size: 3em; margin-bottom: 15px;">üìä</div>
                    <h4>K√©o th·∫£ file Excel ho·∫∑c click ƒë·ªÉ ch·ªçn</h4>
                    <p style="color: #7f8c8d; margin-top: 10px;">
                        H·ªó tr·ª£ ƒë·ªãnh d·∫°ng MEXC Trading Report<br>
                        .xlsx, .xls, .csv - T·ªëi ƒëa: 10MB
                    </p>
                </div>
                
                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls,.csv">
                
                <div class="alert alert-success" id="successAlert"></div>
                <div class="alert alert-error" id="errorAlert"></div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>ƒêang ph√¢n t√≠ch d·ªØ li·ªáu trading...</p>
                </div>

                <div style="margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="downloadTemplate()">
                        üì• T·∫£i Template MEXC
                    </button>
                    <button class="btn btn-success" onclick="exportAnalysis()" id="exportBtn">
                        üì§ Export Ph√¢n T√≠ch
                    </button>
                </div>
            </div>

            <!-- Chart Analysis -->
            <div class="card">
                <h3>üìà Bi·ªÉu ƒê·ªì P&L T√≠ch L≈©y</h3>
                <div class="chart-container">
                    <canvas id="profitChart"></canvas>
                </div>
            </div>

            <!-- Performance Analysis -->
            <div class="card full-width">
                <h3>üìã Ph√¢n T√≠ch Chi Ti·∫øt</h3>
                
                <div style="overflow-x: auto;">
                    <table class="data-table" id="analysisTable">
                        <thead>
                            <tr>
                                <th>Ch·ªâ S·ªë</th>
                                <th>Gi√° Tr·ªã (USD)</th>
                                <th>Gi√° Tr·ªã (VND)</th>
                                <th>Ph·∫ßn TrƒÉm</th>
                                <th>ƒê√°nh Gi√°</th>
                            </tr>
                        </thead>
                        <tbody id="analysisBody">
                            <tr>
                                <td><strong>T·ªïng L√£i</strong></td>
                                <td class="profit">$183.16</td>
                                <td class="profit">4,762,097 VND</td>
                                <td class="profit">91.11%</td>
                                <td><span class="stat-change profit-bg">Xu·∫•t s·∫Øc</span></td>
                            </tr>
                            <tr>
                                <td><strong>T·ªïng L·ªó</strong></td>
                                <td class="loss">-$10.92</td>
                                <td class="loss">-283,809 VND</td>
                                <td class="loss">5.96%</td>
                                <td><span class="stat-change profit-bg">Ki·ªÉm so√°t t·ªët</span></td>
                            </tr>
                            <tr>
                                <td><strong>Ph√≠ Giao D·ªãch</strong></td>
                                <td class="loss">-$5.37</td>
                                <td class="loss">-139,658 VND</td>
                                <td class="loss">2.93%</td>
                                <td><span class="stat-change profit-bg">H·ª£p l√Ω</span></td>
                            </tr>
                            <tr>
                                <td><strong>H·ªá S·ªë L·ª£i Nhu·∫≠n</strong></td>
                                <td class="profit">16.78%</td>
                                <td>-</td>
                                <td>-</td>
                                <td><span class="stat-change profit-bg">R·∫•t t·ªët</span></td>
                            </tr>
                            <tr>
                                <td><strong>ROC (Return on Capital)</strong></td>
                                <td class="profit">9.24%</td>
                                <td>-</td>
                                <td>-</td>
                                <td><span class="stat-change profit-bg">·∫§n t∆∞·ª£ng</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        let tradingData = {};
        let profitChart = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeChart();
            setupEventListeners();
        });

        function setupEventListeners() {
            const uploadArea = document.querySelector('.upload-area');
            const fileInput = document.getElementById('fileInput');

            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }

        function handleFile(file) {
            if (!file) return;

            // Validate file type
            const validTypes = ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 
                              'application/vnd.ms-excel', 'text/csv'];
            
            if (!validTypes.includes(file.type) && !file.name.match(/\.(xlsx|xls|csv)$/i)) {
                showAlert('ƒê·ªãnh d·∫°ng file kh√¥ng h·ªó tr·ª£. Vui l√≤ng ch·ªçn file .xlsx, .xls ho·∫∑c .csv', 'error');
                return;
            }

            // Validate file size (10MB)
            if (file.size > 10 * 1024 * 1024) {
                showAlert('File qu√° l·ªõn. Vui l√≤ng ch·ªçn file nh·ªè h∆°n 10MB', 'error');
                return;
            }

            showLoading(true);
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Process MEXC format
                    processMEXCData(workbook);
                    showAlert(`ƒê√£ ph√¢n t√≠ch th√†nh c√¥ng d·ªØ li·ªáu MEXC trading t·ª´ file: ${file.name}`, 'success');
                } catch (error) {
                    console.error('Error processing file:', error);
                    showAlert('L·ªói khi x·ª≠ l√Ω file. Vui l√≤ng ki·ªÉm tra ƒë·ªãnh d·∫°ng d·ªØ li·ªáu MEXC', 'error');
                } finally {
                    showLoading(false);
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function processMEXCData(workbook) {
            // Find the trading summary sheet
            const sheetNames = workbook.SheetNames;
            let summarySheet = workbook.Sheets[sheetNames[0]];

            const jsonData = XLSX.utils.sheet_to_json(summarySheet, { header: 1 });
            
            // Update dashboard with real data
            updateDashboardFromData(jsonData);
        }

        function updateDashboardFromData(data) {
            // Parse and update real data from Excel
            data.forEach(row => {
                if (!row[0]) return;
                
                const indicator = row[0].toString().trim();
                const usdValue = parseFloat(row[1]) || 0;
                
                // Update specific indicators
                if (indicator.includes('T·ªïng V·ªën Hi·ªán T·∫°i')) {
                    document.getElementById('currentCapital').textContent = `$${usdValue.toLocaleString()}`;
                }
                if (indicator.includes('T·ªïng L√£i/L·ªó R√≤ng')) {
                    document.getElementById('totalPnL').textContent = `$${usdValue.toLocaleString()}`;
                }
                if (indicator.includes('T·ªïng l·ªánh th·ª±c hi·ªán')) {
                    document.getElementById('totalTrades').textContent = usdValue.toString();
                }
            });
        }

        function initializeChart() {
            const ctx = document.getElementById('profitChart');
            if (!ctx) return;

            // Sample data for demo
            const sampleData = {
                labels: ['Ng√†y 1', 'Ng√†y 5', 'Ng√†y 10', 'Ng√†y 15', 'Ng√†y 20', 'Ng√†y 25', 'Ng√†y 31'],
                datasets: [{
                    label: 'P&L T√≠ch L≈©y (USD)',
                    data: [0, 25, 45, 78, 120, 145, 166.87],
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            };

            profitChart = new Chart(ctx, {
                type: 'line',
                data: sampleData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Bi·ªÉu ƒê·ªì P&L T√≠ch L≈©y Theo Th·ªùi Gian'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function showAlert(message, type) {
            const alertId = type === 'success' ? 'successAlert' : 'errorAlert';
            const alertElement = document.getElementById(alertId);
            
            alertElement.textContent = message;
            alertElement.style.display = 'block';
            
            setTimeout(() => {
                alertElement.style.display = 'none';
            }, 5000);
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function downloadTemplate() {
            // Create sample MEXC template
            const templateData = [
                ['Ti√™u ƒë·ªÅ Ch·ªâ s·ªë', 'S·ªë ti·ªÅn (USD)', 'S·ªë ti·ªÅn ∆∞·ªõc t√≠nh (VND)', 'S·ªë ti·ªÅn th·ª±c t·∫ø (VND)', 'Ph·∫ßn trƒÉm %'],
                ['THEO D√ïI V·ªêN', '', '', '', ''],
                ['V·ªën ban ƒë·∫ßu (Ng√†y ƒë·∫ßu ti√™n c√≥ v·ªën)', '1000', '24000000', '24000000', ''],
                ['T·ªïng V·ªën N·∫°p', '1500', '36000000', '36000000', ''],
                ['T·ªïng V·ªën R√∫t', '-200', '-4800000', '-4800000', ''],
                ['T·ªïng L√£i/L·ªó R√≤ng', '150', '3600000', '', ''],
                ['T·ªïng V·ªën Hi·ªán T·∫°i', '1450', '34800000', '34800000', ''],
                ['L·ª£i nhu·∫≠n tr√™n T·ªïng v·ªën (ROC)', '', '', '', '0.15'],
                ['HI·ªÜU SU·∫§T T·ªîNG QUAN', '', '', '', ''],
                ['S·ªë ng√†y c√≥ d·ªØ li·ªáu', '30', '', '', ''],
                ['S·ªë ng√†y c√≥ giao d·ªãch', '15', '', '', ''],
                ['T·ªïng l·ªánh th·ª±c hi·ªán', '100', '', '', ''],
                ['T·ª∑ l·ªá th·∫Øng (%)', '', '', '', '0.8']
            ];

            const ws = XLSX.utils.aoa_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'MEXC Trading Summary');
            
            XLSX.writeFile(wb, 'MEXC_Trading_Template.xlsx');
            showAlert('ƒê√£ t·∫£i xu·ªëng template MEXC th√†nh c√¥ng!', 'success');
        }

        function exportAnalysis() {
            // Export current analysis to Excel
            const analysisData = [
                ['MEXC Trading Analysis Report', '', '', '', ''],
                ['Ng√†y xu·∫•t b√°o c√°o:', new Date().toLocaleDateString('vi-VN'), '', '', ''],
                ['', '', '', '', ''],
                ['Ch·ªâ S·ªë', 'Gi√° Tr·ªã (USD)', 'Gi√° Tr·ªã (VND)', 'Ph·∫ßn TrƒÉm', 'ƒê√°nh Gi√°'],
                ['T·ªïng L√£i', '183.16', '4762097', '91.11%', 'Xu·∫•t s·∫Øc'],
                ['T·ªïng L·ªó', '-10.92', '-283809', '5.96%', 'Ki·ªÉm so√°t t·ªët'],
                ['Ph√≠ Giao D·ªãch', '-5.37', '-139658', '2.93%', 'H·ª£p l√Ω'],
                ['H·ªá S·ªë L·ª£i Nhu·∫≠n', '16.78%', '', '', 'R·∫•t t·ªët'],
                ['ROC (Return on Capital)', '9.24%', '', '', '·∫§n t∆∞·ª£ng']
            ];

            const ws = XLSX.utils.aoa_to_sheet(analysisData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Analysis Report');
            
            const fileName = `MEXC_Analysis_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);
            showAlert('ƒê√£ xu·∫•t b√°o c√°o ph√¢n t√≠ch th√†nh c√¥ng!', 'success');
        }
    </script>
</body>
</html>